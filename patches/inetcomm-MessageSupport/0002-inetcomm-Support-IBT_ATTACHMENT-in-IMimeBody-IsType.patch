From 8a9cecd07299b2dd9da45de570eb1e22c9225e24 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Tue, 12 Jul 2016 12:14:12 +1000
Subject: [PATCH 2/2] inetcomm: Support IBT_ATTACHMENT in IMimeBody IsType

TODO: NQR - Add test to verify.

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/inetcomm/mimeole.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/dlls/inetcomm/mimeole.c b/dlls/inetcomm/mimeole.c
index b1c2bca..023def0 100644
--- a/dlls/inetcomm/mimeole.c
+++ b/dlls/inetcomm/mimeole.c
@@ -1152,6 +1152,7 @@ static HRESULT WINAPI MimeBody_IsType(
                              IMimeBody* iface,
                              IMSGBODYTYPE bodytype)
 {
+    HRESULT hr;
     MimeBody *This = impl_from_IMimeBody(iface);
 
     TRACE("(%p)->(%d)\n", This, bodytype);
@@ -1159,6 +1160,9 @@ static HRESULT WINAPI MimeBody_IsType(
     {
     case IBT_EMPTY:
         return This->data ? S_FALSE : S_OK;
+    case IBT_ATTACHMENT:
+        hr = IMimeBody_IsContentType(&This->IMimeBody_iface, "multipart", NULL);
+        return hr != S_OK ? S_FALSE : S_OK;
     default:
         FIXME("Unimplemented bodytype %d - returning S_OK\n", bodytype);
     }
-- 
1.9.1

