From afcc44ce6133338c704a3da77763bd618b51ace3 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Fri, 15 Apr 2016 15:46:23 +1000
Subject: [PATCH 4/7] inetcomm: Add MimeOleGetPropertySchema stub

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/inetcomm/inetcomm.spec | 2 +-
 dlls/inetcomm/mimeole.c     | 6 ++++++
 include/mimeole.idl         | 2 ++
 3 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/dlls/inetcomm/inetcomm.spec b/dlls/inetcomm/inetcomm.spec
index 0c90b4d..86eb9bd 100644
--- a/dlls/inetcomm/inetcomm.spec
+++ b/dlls/inetcomm/inetcomm.spec
@@ -79,7 +79,7 @@
 @ stdcall MimeOleGetInternat(ptr)
 @ stub MimeOleGetPropA
 @ stub MimeOleGetPropW
-@ stub MimeOleGetPropertySchema
+@ stdcall MimeOleGetPropertySchema(ptr)
 @ stub MimeOleGetRelatedSection
 @ stub MimeOleInetDateToFileTime
 @ stub MimeOleObjectFromMoniker
diff --git a/dlls/inetcomm/mimeole.c b/dlls/inetcomm/mimeole.c
index 8ca8b35..8aebb38 100644
--- a/dlls/inetcomm/mimeole.c
+++ b/dlls/inetcomm/mimeole.c
@@ -3031,3 +3031,9 @@ HRESULT VirtualStream_create(IUnknown *outer, void **obj)
 
     return MimeOleCreateVirtualStream((IStream **)obj);
 }
+
+HRESULT WINAPI MimeOleGetPropertySchema(IMimePropertySchema **schema)
+{
+    FIXME("(%p) stub\n", schema);
+    return E_NOTIMPL;
+}
diff --git a/include/mimeole.idl b/include/mimeole.idl
index c10d8e0..65c0b42 100644
--- a/include/mimeole.idl
+++ b/include/mimeole.idl
@@ -1378,6 +1378,8 @@ cpp_quote("HRESULT WINAPI MimeEditCreateMimeDocument(IUnknown*,IMimeMessage*,DWO
 cpp_quote("HRESULT WINAPI MimeEditGetBackgroundImageUrl(IUnknown*,BSTR*);")
 cpp_quote("HRESULT WINAPI MimeEditDocumentFromStream(IStream*,REFIID,void**);")
 
+cpp_quote("HRESULT WINAPI MimeOleGetPropertySchema(IMimePropertySchema**);")
+
 cpp_quote("#ifdef __cplusplus")
 cpp_quote("}")
 cpp_quote("#endif")
-- 
1.9.1

