From 1b932c49aff9736e286ec07a290ef1056701bd40 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Wed, 27 Apr 2016 11:12:31 +1000
Subject: [PATCH 3/8] inetcomm: Add MimeGetAddressFormatW stub

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/inetcomm/inetcomm.spec | 2 +-
 dlls/inetcomm/mimeole.c     | 8 ++++++++
 include/mimeole.idl         | 2 +-
 3 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/dlls/inetcomm/inetcomm.spec b/dlls/inetcomm/inetcomm.spec
index 86eb9bd..bfd115c 100644
--- a/dlls/inetcomm/inetcomm.spec
+++ b/dlls/inetcomm/inetcomm.spec
@@ -42,7 +42,7 @@
 @ stub MimeEditGetBackgroundImageUrl
 @ stub MimeEditIsSafeToRun
 @ stub MimeEditViewSource
-@ stub MimeGetAddressFormatW
+@ stdcall MimeGetAddressFormatW(ptr ptr long long ptr)
 @ stub MimeOleAlgNameFromSMimeCap
 @ stub MimeOleAlgStrengthFromSMimeCap
 @ stub MimeOleClearDirtyTree
diff --git a/dlls/inetcomm/mimeole.c b/dlls/inetcomm/mimeole.c
index eb6c829..d2db23b 100644
--- a/dlls/inetcomm/mimeole.c
+++ b/dlls/inetcomm/mimeole.c
@@ -3221,3 +3221,11 @@ HRESULT WINAPI MimeOleGetPropertySchema(IMimePropertySchema **schema)
 
     return S_OK;
 }
+
+HRESULT WINAPI MimeGetAddressFormatW(REFIID riid, void *object, DWORD addr_type,
+       ADDRESSFORMAT addr_format, WCHAR **address)
+{
+    FIXME("(%s, %p, %d, %d, %p) stub\n", debugstr_guid(riid), object, addr_type, addr_format, address);
+
+    return E_NOTIMPL;
+}
diff --git a/include/mimeole.idl b/include/mimeole.idl
index bc1f3ac..5990c29 100644
--- a/include/mimeole.idl
+++ b/include/mimeole.idl
@@ -1435,7 +1435,7 @@ cpp_quote("HRESULT WINAPI MimeEditGetBackgroundImageUrl(IUnknown*,BSTR*);")
 cpp_quote("HRESULT WINAPI MimeEditDocumentFromStream(IStream*,REFIID,void**);")
 
 cpp_quote("HRESULT WINAPI MimeOleGetPropertySchema(IMimePropertySchema**);")
-
+cpp_quote("HRESULT WINAPI MimeGetAddressFormatW(REFIID,void*,DWORD,ADDRESSFORMAT,WCHAR**);")
 cpp_quote("#ifdef __cplusplus")
 cpp_quote("}")
 cpp_quote("#endif")
-- 
1.9.1

