From 95f81c4b22e35f11241b80de87df3b38e2dd8c3a Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Thu, 20 Dec 2018 15:26:50 +1100
Subject: [PATCH] mfreadwrite: Return an object from IMFSourceReader
 GetNativeMediaType

---
 dlls/mfreadwrite/Makefile.in | 1 +
 dlls/mfreadwrite/main.c      | 6 ++++--
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/dlls/mfreadwrite/Makefile.in b/dlls/mfreadwrite/Makefile.in
index 4b8ee82..3d2ce74 100644
--- a/dlls/mfreadwrite/Makefile.in
+++ b/dlls/mfreadwrite/Makefile.in
@@ -1,4 +1,5 @@
 MODULE    = mfreadwrite.dll
+IMPORTS   = mfplat
 IMPORTLIB = mfreadwrite
 
 C_SRCS = \
diff --git a/dlls/mfreadwrite/main.c b/dlls/mfreadwrite/main.c
index 224fdd7..0c7fb52 100644
--- a/dlls/mfreadwrite/main.c
+++ b/dlls/mfreadwrite/main.c
@@ -25,6 +25,7 @@
 #include "windef.h"
 #include "winbase.h"
 #include "initguid.h"
+#include "mfapi.h"
 #include "mfreadwrite.h"
 
 #include "wine/debug.h"
@@ -124,8 +125,9 @@ static HRESULT WINAPI src_reader_GetNativeMediaType(IMFSourceReader *iface, DWOR
             IMFMediaType **type)
 {
     srcreader *This = impl_from_IMFSourceReader(iface);
-    FIXME("%p, 0x%08x, %d, %p\n", This, index, typeindex, type);
-    return E_NOTIMPL;
+    FIXME("(%p, 0x%08x, %d, %p) stub\n", This, index, typeindex, type);
+
+    return MFCreateMediaType(type);
 }
 
 static HRESULT WINAPI src_reader_GetCurrentMediaType(IMFSourceReader *iface, DWORD index, IMFMediaType **type)
-- 
1.9.1

