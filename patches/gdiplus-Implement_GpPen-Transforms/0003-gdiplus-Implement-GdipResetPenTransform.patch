From 291f50c2edc95c1c6e5be27f4b73aaa077bdfd48 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Wed, 27 Jan 2016 15:22:43 +1100
Subject: [PATCH 3/3] gdiplus: Implement GdipResetPenTransform

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/gdiplus/pen.c       | 7 ++-----
 dlls/gdiplus/tests/pen.c | 6 +++---
 2 files changed, 5 insertions(+), 8 deletions(-)

diff --git a/dlls/gdiplus/pen.c b/dlls/gdiplus/pen.c
index b232b06..5b5b5f0 100644
--- a/dlls/gdiplus/pen.c
+++ b/dlls/gdiplus/pen.c
@@ -420,17 +420,14 @@ GpStatus WINGDIPAPI GdipGetPenWidth(GpPen *pen, REAL *width)
 
 GpStatus WINGDIPAPI GdipResetPenTransform(GpPen *pen)
 {
-    static int calls;
-
     TRACE("(%p)\n", pen);
 
     if(!pen)
         return InvalidParameter;
 
-    if(!(calls++))
-        FIXME("(%p) stub\n", pen);
+    GdipSetMatrixElements(pen->transform, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0);
 
-    return NotImplemented;
+    return Ok;
 }
 
 GpStatus WINGDIPAPI GdipSetPenTransform(GpPen *pen, GpMatrix *matrix)
diff --git a/dlls/gdiplus/tests/pen.c b/dlls/gdiplus/tests/pen.c
index 691386a..8591a3a 100644
--- a/dlls/gdiplus/tests/pen.c
+++ b/dlls/gdiplus/tests/pen.c
@@ -409,20 +409,20 @@ static void test_transform(void)
     expectf(3.0,  values[5]);
 
     status = GdipResetPenTransform(pen);
-    todo_wine expect(Ok, status);
+    expect(Ok, status);
 
     status = GdipGetPenTransform(pen, matrix);
     expect(Ok, status);
     status = GdipGetMatrixElements(matrix, values);
     expect(Ok, status);
-todo_wine {
+
     expectf(1.0, values[0]);
     expectf(0.0, values[1]);
     expectf(0.0, values[2]);
     expectf(1.0, values[3]);
     expectf(0.0, values[4]);
     expectf(0.0, values[5]);
-}
+
     GdipDeletePen(pen);
 
     GdipDeleteMatrix(matrix);
-- 
2.7.0.rc3

