From c5db094c8363b0b027792c0ba8d03c53a8a13c2e Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Thu, 6 Jul 2017 14:20:05 +1000
Subject: [PATCH] include: Support all version of BackgroundCopyManager from
 bits.h

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 include/bits1_5.idl | 2 ++
 include/bits2_0.idl | 5 +++++
 include/bits2_5.idl | 2 ++
 3 files changed, 9 insertions(+)

diff --git a/include/bits1_5.idl b/include/bits1_5.idl
index 274a7de..5937ce0 100644
--- a/include/bits1_5.idl
+++ b/include/bits1_5.idl
@@ -86,3 +86,5 @@ interface IBackgroundCopyJob2 : IBackgroundCopyJob
     HRESULT SetCredentials(BG_AUTH_CREDENTIALS *cred);
     HRESULT RemoveCredentials(BG_AUTH_TARGET target, BG_AUTH_SCHEME scheme);
 }
+
+cpp_quote("#include \"bits2_0.h\"")
diff --git a/include/bits2_0.idl b/include/bits2_0.idl
index efe6dde..1d17c38 100644
--- a/include/bits2_0.idl
+++ b/include/bits2_0.idl
@@ -32,11 +32,14 @@ cpp_quote("#define BG_COPY_FILE_ALL   15")
 
 cpp_quote("#define BG_LENGTH_TO_EOF (UINT64)(-1)")
 
+cpp_quote("#ifndef _BG_FILE_RANGE_DEFINED")
+cpp_quote("#define _BG_FILE_RANGE_DEFINED")
 typedef struct _BG_FILE_RANGE
 {
     UINT64 InitialOffset;
     UINT64 Length;
 } BG_FILE_RANGE;
+cpp_quote("#endif")
 
 [
     uuid(443c8934-90ff-48ed-bcde-26f5c7450042),
@@ -93,3 +96,5 @@ library BackgroundCopyManager2_0
     interface IBackgroundCopyJob3;
     interface IBackgroundCopyFile2;
 }
+
+cpp_quote("#include \"bits2_5.h\"")
diff --git a/include/bits2_5.idl b/include/bits2_5.idl
index 29ea75c..c58dc8a 100644
--- a/include/bits2_5.idl
+++ b/include/bits2_5.idl
@@ -98,3 +98,5 @@ library BackgroundCopyManager2_5
     interface IBackgroundCopyCallback;
     interface IBackgroundCopyJobHttpOptions;
 }
+
+cpp_quote("#include \"bits3_0.h\"")
-- 
1.9.1

