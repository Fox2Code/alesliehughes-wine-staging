From 488bed71b74646d240064e6d6e456e61a4064ab0 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Wed, 21 Jun 2017 15:17:42 +1000
Subject: [PATCH 2/3] qmgr/tests: Add BackgroundCopyManager3_0 test

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/qmgr/tests/job.c  |  1 +
 dlls/qmgr/tests/qmgr.c | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+)

diff --git a/dlls/qmgr/tests/job.c b/dlls/qmgr/tests/job.c
index 83134e5718..9d9517edd6 100644
--- a/dlls/qmgr/tests/job.c
+++ b/dlls/qmgr/tests/job.c
@@ -27,6 +27,7 @@
 #include "initguid.h"
 #include "bits2_0.h"
 #include "bits2_5.h"
+#include "bits3_0.h"
 
 /* Globals used by many tests */
 static const WCHAR test_displayName[] = {'T', 'e', 's', 't', 0};
diff --git a/dlls/qmgr/tests/qmgr.c b/dlls/qmgr/tests/qmgr.c
index 4ab12d3360..28d150c68a 100644
--- a/dlls/qmgr/tests/qmgr.c
+++ b/dlls/qmgr/tests/qmgr.c
@@ -24,6 +24,7 @@
 
 #include "wine/test.h"
 #include "bits.h"
+#include "bits3_0.h"
 
 static WCHAR progname[MAX_PATH];
 
@@ -187,6 +188,22 @@ static void test_globalness(void)
     IBackgroundCopyManager_Release(manager);
 }
 
+static void test_interfaces(void)
+{
+    IBackgroundCopyManager *manager = NULL;
+    HRESULT hres;
+    hres = CoCreateInstance(&CLSID_BackgroundCopyManager3_0, NULL,
+                            CLSCTX_LOCAL_SERVER, &IID_IBackgroundCopyManager,
+                            (void **) &manager);
+    if(FAILED(hres))
+    {
+        win_skip("BackgroundCopyManager3_0 not supported.\n");
+        return;
+    }
+
+    IBackgroundCopyManager_Release(manager);
+}
+
 START_TEST(qmgr)
 {
     char **argv;
@@ -209,6 +226,7 @@ START_TEST(qmgr)
         test_CreateJob();
         test_EnumJobs();
         test_globalness();
+        test_interfaces();
     }
     CoUninitialize();
 }
-- 
2.11.0

