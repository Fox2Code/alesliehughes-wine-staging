From 6c4208fb2d6c8590fb4823775fd000683948ba74 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Mon, 21 Dec 2020 15:50:29 +1100
Subject: [PATCH] include: Add mulres.idl

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/msdaps/usrmarshal.c | 14 ++++++++++++
 include/Makefile.in      |  1 +
 include/mulres.idl       | 48 ++++++++++++++++++++++++++++++++++++++++
 include/oledb.idl        |  1 +
 4 files changed, 64 insertions(+)
 create mode 100644 include/mulres.idl

diff --git a/dlls/msdaps/usrmarshal.c b/dlls/msdaps/usrmarshal.c
index 917395b37bd..75ba1ef40dc 100644
--- a/dlls/msdaps/usrmarshal.c
+++ b/dlls/msdaps/usrmarshal.c
@@ -1630,6 +1630,20 @@ HRESULT __RPC_STUB IConvertType_CanConvert_Stub(IConvertType* This, DBTYPE from,
     return E_NOTIMPL;
 }
 
+HRESULT __RPC_STUB IMultipleResults_GetResult_Stub(IMultipleResults* This, IUnknown *outer,
+    DBRESULTFLAG result, REFIID riid, DBROWCOUNT *affected, IUnknown **rowset, IErrorInfo **error)
+{
+    FIXME("(%p)->(%p %d %s %p %p %p): stub\n", This, outer, result, debugstr_guid(riid), affected, rowset, error);
+    return E_NOTIMPL;
+}
+
+HRESULT CALLBACK IMultipleResults_GetResult_Proxy(IMultipleResults* This, IUnknown *outer,
+    DBRESULTFLAG result, REFIID riid, DBROWCOUNT *affected, IUnknown **rowset)
+{
+    FIXME("(%p)->(%p %d %s %p %p): stub\n", This, outer, result, debugstr_guid(riid), affected, rowset);
+    return E_NOTIMPL;
+}
+
 HRESULT CALLBACK ICommandPrepare_Prepare_Proxy(ICommandPrepare* This, ULONG runs)
 {
     FIXME("(%p)->(%d): stub\n", This, runs);
diff --git a/include/Makefile.in b/include/Makefile.in
index 5649bd6c361..eb0dacc2656 100644
--- a/include/Makefile.in
+++ b/include/Makefile.in
@@ -524,6 +524,7 @@ SOURCES = \
 	netioapi.h \
 	netlistmgr.idl \
 	newdev.h \
+	mulres.idl \
 	nldef.h \
 	npapi.h \
 	nserror.h \
diff --git a/include/mulres.idl b/include/mulres.idl
new file mode 100644
index 00000000000..00cf565ed99
--- /dev/null
+++ b/include/mulres.idl
@@ -0,0 +1,48 @@
+/*
+ * Copyright (C) 2020 Alistair Leslie-Hughes
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
+ */
+
+#if 0
+#pragma makedep install
+#endif
+
+[
+    object,
+    uuid(0c733a90-2a1c-11ce-ade5-00aa0044773d),
+    pointer_default(unique)
+]
+interface IMultipleResults : IUnknown
+{
+    typedef DB_LRESERVE DBRESULTFLAG;
+
+    enum DBRESULTFLAGENUM
+    {
+        DBRESULTFLAG_DEFAULT = 0,
+        DBRESULTFLAG_ROWSET  = 1,
+        DBRESULTFLAG_ROW     = 2,
+    };
+
+    [local]
+    HRESULT GetResult([in] IUnknown *outer, [in] DBRESULTFLAG result, [in] REFIID riid, [out] DBROWCOUNT *affected,
+            [out, iid_is(riid), annotation("_Outptr_opt_result_maybenull_")] IUnknown ** rowset);
+
+    [call_as(GetResult)]
+    HRESULT RemoteGetResult([in] IUnknown *outer, [in] DBRESULTFLAG result, [in] REFIID riid,
+            [in, out, unique] DBROWCOUNT *affected, [in, out, unique, iid_is(riid)] IUnknown **rowset,
+            [out] IErrorInfo **error);
+}
+
diff --git a/include/oledb.idl b/include/oledb.idl
index 4e333353a5e..475eb85642e 100644
--- a/include/oledb.idl
+++ b/include/oledb.idl
@@ -77,6 +77,7 @@ typedef LONG_PTR DB_LRESERVE;
 #include "cmdpre.idl"
 #include "rstchg.idl"
 #include "rstupd.idl"
+#include "mulres.idl"
 
 cpp_quote("#include <accctrl.h>")
 
-- 
2.29.2

