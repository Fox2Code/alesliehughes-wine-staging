From f38eae8dd97cbfd2694e409a24a8f0fb233ef7e8 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Sun, 25 Oct 2020 18:55:19 +1100
Subject: [PATCH] include: Add ICommandProperties interface

---
 dlls/msdaps/usrmarshal.c | 27 ++++++++++++++++++++++++
 include/cmdprp.idl       | 44 ++++++++++++++++++++++++++++++++++++++++
 include/oledb.idl        |  1 +
 3 files changed, 72 insertions(+)
 create mode 100644 include/cmdprp.idl

diff --git a/dlls/msdaps/usrmarshal.c b/dlls/msdaps/usrmarshal.c
index 2fe4e60b68b..4759d08f1de 100644
--- a/dlls/msdaps/usrmarshal.c
+++ b/dlls/msdaps/usrmarshal.c
@@ -1589,3 +1589,30 @@ HRESULT __RPC_STUB IGetDataSource_GetDataSource_Stub(IGetDataSource* This, REFII
     FIXME("(%p)->(%s %p %p): stub\n", This, debugstr_guid(riid), datasource, error);
     return E_NOTIMPL;
 }
+
+HRESULT CALLBACK ICommandProperties_GetProperties_Proxy(ICommandProperties* This, const ULONG count,
+    const DBPROPIDSET propertyidsets[], ULONG *sets_cnt, DBPROPSET **propertyset)
+{
+    FIXME("(%p)->(%d %p %p %p): stub\n", This, count, propertyidsets, sets_cnt, propertyset);
+    return E_NOTIMPL;
+}
+
+HRESULT __RPC_STUB ICommandProperties_GetProperties_Stub(ICommandProperties* This, const ULONG count,
+    const DBPROPIDSET *propertyidsets, ULONG *sets_cnt, DBPROPSET **propertyset, IErrorInfo **error)
+{
+    FIXME("(%p)->(%d %p %p %p %p): stub\n", This, count, propertyidsets, sets_cnt, propertyset, error);
+    return E_NOTIMPL;
+}
+
+HRESULT CALLBACK ICommandProperties_SetProperties_Proxy(ICommandProperties* This, ULONG count, DBPROPSET propertyset[])
+{
+    FIXME("(%p)->(%d %p %p %p %p): stub\n", This, count, propertyset);
+    return E_NOTIMPL;
+}
+
+HRESULT __RPC_STUB ICommandProperties_SetProperties_Stub(ICommandProperties* This, ULONG count,
+    DBPROPSET *propertyset, ULONG total, DBPROPSTATUS *propstatus, IErrorInfo **error)
+{
+    FIXME("(%p)->(%d %p %d %p %p): stub\n", This, count, propertyset, total, propstatus, error);
+    return E_NOTIMPL;
+}
\ No newline at end of file
diff --git a/include/cmdprp.idl b/include/cmdprp.idl
new file mode 100644
index 00000000000..ce9e7075523
--- /dev/null
+++ b/include/cmdprp.idl
@@ -0,0 +1,44 @@
+/*
+ * Copyright (C) 2020 Alistair Leslie-Hughes
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
+ */
+
+#if 0
+#pragma makedep install
+#endif
+
+[
+    object,
+    uuid(0c733a79-2a1c-11ce-ade5-00aa0044773d),
+    pointer_default(unique)
+]
+interface ICommandProperties : IUnknown
+{
+    [local]
+    HRESULT GetProperties([in] ULONG count, [in, size_is(count)] const DBPROPIDSET propertyidsets[],
+        [in, out] ULONG *sets_cnt, [out, size_is(,*sets_cnt)] DBPROPSET **propertyset);
+
+    [call_as(GetProperties)]
+    HRESULT RemoteGetProperties([in] ULONG count, [in, unique, size_is(count)] const DBPROPIDSET *propertyidsets,
+        [in, out] ULONG *sets_cnt, [out, size_is(,*sets_cnt)] DBPROPSET **propertyset, [out] IErrorInfo **error);
+
+    [local]
+    HRESULT SetProperties([in] ULONG count, [in, out, unique, size_is(count)] DBPROPSET propertyset[]);
+
+    [call_as(SetProperties)]
+    HRESULT RemoteSetProperties([in] ULONG count, [in, unique, size_is(count)] DBPROPSET *propertyset,
+            [in] ULONG total, [out, size_is(total)] DBPROPSTATUS *propstatus, [out] IErrorInfo **error);
+}
diff --git a/include/oledb.idl b/include/oledb.idl
index 87d148f67b4..4370c7f6bcc 100644
--- a/include/oledb.idl
+++ b/include/oledb.idl
@@ -71,6 +71,7 @@ typedef DWORD_PTR DBHASHVALUE;
 #include "errrec.idl"
 #include "getdts.idl"
 #include "cmdstrm.idl"
+#include "cmdprp.idl"
 
 cpp_quote("#include <accctrl.h>")
 
-- 
2.28.0

