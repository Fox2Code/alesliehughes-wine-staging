From 5d4b0e2de5a56da0b7de48851e8db47a5810f74a Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Tue, 27 Oct 2020 11:45:57 +1100
Subject: [PATCH] include: Add ICommandPrepare interface

---
 dlls/msdaps/usrmarshal.c | 24 +++++++++++++++++++++++
 include/cmdpre.idl       | 41 ++++++++++++++++++++++++++++++++++++++++
 include/oledb.idl        |  1 +
 3 files changed, 66 insertions(+)
 create mode 100644 include/cmdpre.idl

diff --git a/dlls/msdaps/usrmarshal.c b/dlls/msdaps/usrmarshal.c
index 905afb22290..2b479ef5502 100644
--- a/dlls/msdaps/usrmarshal.c
+++ b/dlls/msdaps/usrmarshal.c
@@ -1670,4 +1670,28 @@ HRESULT __RPC_STUB ICommandWithParameters_SetParameterInfo_Stub(
 {
     FIXME("(%p)->(%d %p %p %p): stub\n", This, cParams, rgParamOrdinals, rgParamBindInfo, ppErrorInfoRem);
     return E_NOTIMPL;
+}
+
+HRESULT CALLBACK ICommandPrepare_Prepare_Proxy(ICommandPrepare* This, ULONG runs)
+{
+    FIXME("(%p)->(%d): stub\n", This, runs);
+    return E_NOTIMPL;
+}
+
+HRESULT __RPC_STUB ICommandPrepare_Prepare_Stub(ICommandPrepare* This, ULONG runs, IErrorInfo **error)
+{
+    FIXME("(%p)->(%d %p): stub\n", This, runs, error);
+    return E_NOTIMPL;
+}
+
+HRESULT CALLBACK ICommandPrepare_Unprepare_Proxy(ICommandPrepare* This)
+{
+    FIXME("(%p)->(): stub\n", This);
+    return E_NOTIMPL;
+}
+
+HRESULT __RPC_STUB ICommandPrepare_Unprepare_Stub(ICommandPrepare* This, IErrorInfo **error)
+{
+    FIXME("(%p)->(%p): stub\n", This, error);
+    return E_NOTIMPL;
 }
\ No newline at end of file
diff --git a/include/cmdpre.idl b/include/cmdpre.idl
new file mode 100644
index 00000000000..695149aae50
--- /dev/null
+++ b/include/cmdpre.idl
@@ -0,0 +1,41 @@
+/*
+ * Copyright (C) 2020 Alistair Leslie-Hughes
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
+ */
+
+#if 0
+#pragma makedep install
+#endif
+
+[
+    object,
+    uuid(0c733a26-2a1c-11ce-ade5-00aa0044773d),
+    pointer_default(unique)
+]
+interface ICommandPrepare : IUnknown
+{
+    [local]
+    HRESULT Prepare([in] ULONG runs);
+
+    [call_as(Prepare)]
+    HRESULT RemotePrepare([in] ULONG runs,[out] IErrorInfo **error);
+
+    [local]
+    HRESULT Unprepare();
+
+    [call_as(Unprepare)]
+    HRESULT RemoteUnprepare([out] IErrorInfo **error);
+}
diff --git a/include/oledb.idl b/include/oledb.idl
index 0ef5fd61e4e..cad2cb2d398 100644
--- a/include/oledb.idl
+++ b/include/oledb.idl
@@ -79,6 +79,7 @@ cpp_quote("#endif")
 #include "cmdprp.idl"
 #include "cvttyp.idl"
 #include "cmdwpr.idl"
+#include "cmdpre.idl"
 
 cpp_quote("#include <accctrl.h>")
 
-- 
2.28.0

