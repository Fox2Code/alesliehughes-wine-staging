From e7fb7f2170587e65a05080c80ed3d833693d24e8 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Mon, 12 Oct 2020 18:33:26 +1100
Subject: [PATCH] include: Add interface IGetDataSource

Signed-off-by: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
---
 dlls/msdaps/usrmarshal.c | 13 +++++++++++++
 include/getdts.idl       | 34 ++++++++++++++++++++++++++++++++++
 include/oledb.idl        |  1 +
 3 files changed, 48 insertions(+)
 create mode 100644 include/getdts.idl

diff --git a/dlls/msdaps/usrmarshal.c b/dlls/msdaps/usrmarshal.c
index 43e3aaeaa1a..2fe4e60b68b 100644
--- a/dlls/msdaps/usrmarshal.c
+++ b/dlls/msdaps/usrmarshal.c
@@ -1576,3 +1576,16 @@ HRESULT __RPC_STUB IColumnsInfo_MapColumnIDs_Stub(IColumnsInfo* This, DBORDINAL
     FIXME("(%p)->(%lu %p %p %p): stub\n", This, column_ids, dbids, columns, error);
     return E_NOTIMPL;
 }
+
+HRESULT CALLBACK IGetDataSource_GetDataSource_Proxy(IGetDataSource* This, REFIID riid, IUnknown **datasource)
+{
+    FIXME("(%p)->(%s %p): stub\n", This, debugstr_guid(riid), datasource);
+    return E_NOTIMPL;
+}
+
+HRESULT __RPC_STUB IGetDataSource_GetDataSource_Stub(IGetDataSource* This, REFIID riid, IUnknown **datasource,
+    IErrorInfo **error)
+{
+    FIXME("(%p)->(%s %p %p): stub\n", This, debugstr_guid(riid), datasource, error);
+    return E_NOTIMPL;
+}
diff --git a/include/getdts.idl b/include/getdts.idl
new file mode 100644
index 00000000000..40991070cc1
--- /dev/null
+++ b/include/getdts.idl
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2020 Alistair Leslie-Hughes
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Lesser General Public
+ * License as published by the Free Software Foundation; either
+ * version 2.1 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Lesser General Public License for more details.
+ *
+ * You should have received a copy of the GNU Lesser General Public
+ * License along with this library; if not, write to the Free Software
+ * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
+ */
+#if 0
+#pragma makedep install
+#endif
+
+[
+    object,
+    uuid(0c733a75-2a1c-11ce-ade5-00aa0044773d),
+    pointer_default(unique)
+]
+interface IGetDataSource : IUnknown
+{
+    [local]
+    HRESULT GetDataSource([in] REFIID riid, [out, iid_is(riid)] IUnknown **datasource);
+
+    [call_as(GetDataSource)]
+    HRESULT RemoteGetDataSource([in] REFIID riid, [out, iid_is(riid)] IUnknown **datasource, [out] IErrorInfo **error);
+}
diff --git a/include/oledb.idl b/include/oledb.idl
index 537bb211cc5..1ffbefa9ffd 100644
--- a/include/oledb.idl
+++ b/include/oledb.idl
@@ -69,6 +69,7 @@ typedef DWORD_PTR DBHASHVALUE;
 #include "binres.idl"
 #include "crtrow.idl"
 #include "errrec.idl"
+#include "getdts.idl"
 
 cpp_quote("#include <accctrl.h>")
 
-- 
2.28.0

